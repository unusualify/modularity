{"ast":null,"code":"import _defineProperty from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _toConsumableArray from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nvar _mutations, _actions;\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport api from '@/store/api/form';\nimport { FORM, ALERT } from '@/store/mutations';\nimport ACTIONS from '@/store/actions';\nimport { getFormData, getFormFields, getModalFormFields, getSchemaModel } from '@/utils/getFormData.js';\nvar getFieldIndex = function getFieldIndex(stateKey, field) {\n  return stateKey.findIndex(function (f) {\n    return f.name === field.name;\n  });\n};\nvar state = {\n  baseUrl: window[process.env.VUE_APP_NAME].STORE.form.baseUrl || '',\n  inputs: window[process.env.VUE_APP_NAME].STORE.form.inputs,\n  saveUrl: window[process.env.VUE_APP_NAME].STORE.form.saveUrl || '',\n  /**\n   * Form errors after submitting\n   * @type {Object}\n   */\n  errors: {},\n  // fields: window[process.env.VUE_APP_NAME].STORE.form.inputs.forEach(function(el ){\n  //     return {\n  //       name: el.name,\n  //       value: null\n  //     };\n  // }),\n\n  // editedItem: window[process.env.VUE_APP_NAME].STORE.form.inputs.reduce( (a,c) => (a[c.name] = c.default ?? '', a), {}),\n  // editedItem: Object.keys(window[process.env.VUE_APP_NAME].STORE.form.inputs).reduce( (a,c) => (a[window[process.env.VUE_APP_NAME].STORE.form.inputs[c].name] = window[process.env.VUE_APP_NAME].STORE.form.inputs[c].hasOwnProperty('default') ? window[process.env.VUE_APP_NAME].STORE.form.inputs[c].default : '', a), {}),\n  editedItem: getSchemaModel(window[process.env.VUE_APP_NAME].STORE.form.inputs),\n  /**\n   * Force reload on successful submit\n   * @type {Boolean}\n   */\n  reloadOnSuccess: window[process.env.VUE_APP_NAME].STORE.form.reloadOnSuccess || false,\n  /**\n   * Determines if the form should prevent submitting before an input value is pushed into the store\n   * @type {Boolean}\n   */\n  isSubmitPrevented: false,\n  loading: false\n};\n\n// getters\nvar getters = {\n  defaultItem: function defaultItem(state) {\n    // __log(state.editedItem)\n    return state.editedItem;\n    // return state.inputs.reduce( (a,c) => (a[c.name] = c.hasOwnProperty('default') ? c.default : '', a), {})\n  }\n};\n\nvar mutations = (_mutations = {}, _defineProperty(_mutations, FORM.SET_EDITED_ITEM, function (state, item) {\n  state.editedItem = Object.assign({}, item);\n}), _defineProperty(_mutations, FORM.PREVENT_SUBMIT, function (state) {\n  state.isSubmitPrevented = true;\n}), _defineProperty(_mutations, FORM.ALLOW_SUBMIT, function (state) {\n  state.isSubmitPrevented = false;\n}), _defineProperty(_mutations, FORM.EMPTY_FORM_FIELDS, function (state, status) {\n  state.fields = [];\n}), _defineProperty(_mutations, FORM.ADD_FORM_FIELDS, function (state, fields) {\n  state.fields = [].concat(_toConsumableArray(state.fields), _toConsumableArray(fields));\n}), _defineProperty(_mutations, FORM.REPLACE_FORM_FIELDS, function (state, fields) {\n  state.fields = fields;\n}), _defineProperty(_mutations, FORM.UPDATE_FORM_FIELD, function (state, field) {\n  var fieldValue = field.locale ? {} : null;\n  var fieldIndex = getFieldIndex(state.fields, field);\n  // Update existing form field\n  if (fieldIndex !== -1) {\n    if (field.locale) fieldValue = state.fields[fieldIndex].value || {};\n    // remove existing field\n    state.fields.splice(fieldIndex, 1);\n  }\n  if (field.locale) fieldValue[field.locale] = field.value;else fieldValue = field.value;\n  state.fields.push({\n    name: field.name,\n    value: fieldValue\n  });\n}), _defineProperty(_mutations, FORM.REMOVE_FORM_FIELD, function (state, fieldName) {\n  state.fields.forEach(function (field, index) {\n    if (field.name === fieldName) state.fields.splice(index, 1);\n  });\n}), _defineProperty(_mutations, FORM.EMPTY_MODAL_FIELDS, function (state, status) {\n  state.modalFields = [];\n}), _defineProperty(_mutations, FORM.REPLACE_MODAL_FIELDS, function (state, fields) {\n  state.modalFields = fields;\n}), _defineProperty(_mutations, FORM.UPDATE_MODAL_FIELD, function (state, field) {\n  var fieldValue = field.locale ? {} : null;\n  var fieldIndex = getFieldIndex(state.modalFields, field);\n\n  // Update existing form field\n  if (fieldIndex !== -1) {\n    if (field.locale) fieldValue = state.modalFields[fieldIndex].value;\n    // remove existing field\n    state.modalFields.splice(fieldIndex, 1);\n  }\n  if (field.locale) fieldValue[field.locale] = field.value;else fieldValue = field.value;\n  state.modalFields.push({\n    name: field.name,\n    value: fieldValue\n  });\n}), _defineProperty(_mutations, FORM.REMOVE_MODAL_FIELD, function (state, fieldName) {\n  state.modalFields.forEach(function (field, index) {\n    if (field.name === fieldName) state.modalFields.splice(index, 1);\n  });\n}), _defineProperty(_mutations, FORM.UPDATE_FORM_LOADING, function (state, loading) {\n  state.loading = loading || !state.loading;\n}), _defineProperty(_mutations, FORM.SET_FORM_ERRORS, function (state, errors) {\n  state.errors = errors;\n}), _defineProperty(_mutations, FORM.CLEAR_FORM_ERRORS, function (state) {\n  state.errors = [];\n}), _defineProperty(_mutations, FORM.UPDATE_FORM_SAVE_TYPE, function (state, type) {\n  state.type = type;\n}), _mutations);\nvar actions = (_actions = {}, _defineProperty(_actions, ACTIONS.SAVE_FORM, function (_ref, _ref2) {\n  var commit = _ref.commit,\n    state = _ref.state,\n    getters = _ref.getters,\n    rootState = _ref.rootState,\n    dispatch = _ref.dispatch;\n  var _ref2$item = _ref2.item,\n    item = _ref2$item === void 0 ? null : _ref2$item,\n    _ref2$callback = _ref2.callback,\n    callback = _ref2$callback === void 0 ? null : _ref2$callback,\n    _ref2$errorCallback = _ref2.errorCallback,\n    errorCallback = _ref2$errorCallback === void 0 ? null : _ref2$errorCallback;\n  commit(FORM.CLEAR_FORM_ERRORS);\n  commit(FORM.UPDATE_FORM_LOADING, true);\n\n  // commit(NOTIFICATION.CLEAR_NOTIF, 'error')\n\n  // update or create etc...\n  // commit(FORM.UPDATE_FORM_SAVE_TYPE, saveType)\n\n  // we can now create our submitted data object out of:\n  // - our just created fields object,\n  // - publication properties\n  // - selected medias and browsers\n  // - created blocks and repeaters\n\n  // const data = getFormData(rootState)\n  var data = item !== null && item !== void 0 ? item : state.editedItem;\n\n  // const method = rootState.publication.createWithoutModal ? 'post' : 'put'\n  var method = 'post';\n  var url = window[process.env.VUE_APP_NAME].ENDPOINTS.store;\n  if (data.hasOwnProperty('id')) {\n    method = 'put';\n    url = window[process.env.VUE_APP_NAME].ENDPOINTS.update.replace(':id', data.id);\n  }\n  api[method](url, data, function (response) {\n    commit(FORM.UPDATE_FORM_LOADING, false);\n    // __log(\n    //   response\n    // )\n    // if (successResponse.data.hasOwnProperty('redirect')) {\n    //   window.location.replace(successResponse.data.redirect)\n    // }\n\n    // if (state.reloadOnSuccess) {\n    //   window.location.reload()\n    // }\n\n    // commit(PUBLICATION.UPDATE_PUBLISH_SUBMIT)\n    // if (successResponse.data.hasOwnProperty('revisions')) {\n    //   commit(REVISION.UPDATE_REV_ALL, successResponse.data.revisions)\n    // }\n    // __log(reload)\n    if (response.data.hasOwnProperty('errors')) {\n      commit(FORM.SET_FORM_ERRORS, response.data.errors);\n    } else if (response.data.hasOwnProperty('variant') && response.data.variant == 'success') {\n      commit(ALERT.SET_ALERT, {\n        message: response.data.message,\n        variant: response.data.variant\n      });\n      if (!data.hasOwnProperty('reload') || data.reload) {\n        dispatch(ACTIONS.GET_DATATABLE);\n      }\n    }\n    if (callback && typeof callback === 'function') callback(response.data);\n  }, function (errorResponse) {\n    commit(FORM.UPDATE_FORM_LOADING, false);\n    if (errorResponse.response.data.hasOwnProperty('exception')) {\n      commit(ALERT.SET_ALERT, {\n        message: 'Your submission could not be processed.',\n        variant: 'error'\n      });\n    } else {\n      dispatch(ACTIONS.HANDLE_ERRORS, errorResponse.response.data);\n      commit(ALERT.SET_ALERT, {\n        message: 'Your submission could not be validated, please fix and retry',\n        variant: 'error'\n      });\n    }\n    if (errorCallback && typeof errorCallback === 'function') errorCallback(errorResponse.data);\n  });\n}), _defineProperty(_actions, ACTIONS.HANDLE_ERRORS, function (_ref3, errors) {\n  var commit = _ref3.commit,\n    state = _ref3.state,\n    getters = _ref3.getters,\n    rootState = _ref3.rootState;\n  var repeaters = rootState.repeaters;\n  // Translate the errors to their respective fields.\n  Object.keys(errors).forEach(function (errorKey) {\n    var splitted = errorKey.split('.');\n    if (splitted.length >= 4) {\n      var type = splitted[0];\n      var subType = splitted[1];\n      var index = splitted[2];\n      var field = splitted[3];\n      if (type === 'repeaters') {\n        var id = repeaters[subType][index].id;\n        var newErrorKey = \"blocks[\".concat(id, \"][\").concat(field, \"]\");\n        errors[newErrorKey] = errors[errorKey];\n      }\n    }\n  });\n  commit(FORM.SET_FORM_ERRORS, errors);\n}), _actions);\nexport default {\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};","map":{"version":3,"names":["api","FORM","ALERT","ACTIONS","getFormData","getFormFields","getModalFormFields","getSchemaModel","getFieldIndex","stateKey","field","findIndex","f","name","state","baseUrl","window","process","env","VUE_APP_NAME","STORE","form","inputs","saveUrl","errors","editedItem","reloadOnSuccess","isSubmitPrevented","loading","getters","defaultItem","mutations","_mutations","_defineProperty","SET_EDITED_ITEM","item","Object","assign","PREVENT_SUBMIT","ALLOW_SUBMIT","EMPTY_FORM_FIELDS","status","fields","ADD_FORM_FIELDS","concat","_toConsumableArray","REPLACE_FORM_FIELDS","UPDATE_FORM_FIELD","fieldValue","locale","fieldIndex","value","splice","push","REMOVE_FORM_FIELD","fieldName","forEach","index","EMPTY_MODAL_FIELDS","modalFields","REPLACE_MODAL_FIELDS","UPDATE_MODAL_FIELD","REMOVE_MODAL_FIELD","UPDATE_FORM_LOADING","SET_FORM_ERRORS","CLEAR_FORM_ERRORS","UPDATE_FORM_SAVE_TYPE","type","actions","_actions","SAVE_FORM","_ref","_ref2","commit","rootState","dispatch","_ref2$item","_ref2$callback","callback","_ref2$errorCallback","errorCallback","data","method","url","ENDPOINTS","store","hasOwnProperty","update","replace","id","response","variant","SET_ALERT","message","reload","GET_DATATABLE","errorResponse","HANDLE_ERRORS","_ref3","repeaters","keys","errorKey","splitted","split","length","subType","newErrorKey"],"sources":["/var/www/crm_template/packages/oobook/crm-base/vue/src/js/store/modules/form.js"],"sourcesContent":["import api from '@/store/api/form'\nimport { FORM, ALERT } from '@/store/mutations'\nimport ACTIONS from '@/store/actions'\n\nimport { getFormData, getFormFields, getModalFormFields, getSchemaModel } from '@/utils/getFormData.js'\n\nconst getFieldIndex = (stateKey, field) => {\n  return stateKey.findIndex(f => f.name === field.name)\n}\n\nconst state = {\n\n  baseUrl: window[process.env.VUE_APP_NAME].STORE.form.baseUrl || '',\n\n  inputs: window[process.env.VUE_APP_NAME].STORE.form.inputs,\n\n  saveUrl: window[process.env.VUE_APP_NAME].STORE.form.saveUrl || '',\n\n  /**\n   * Form errors after submitting\n   * @type {Object}\n   */\n  errors: {},\n\n  // fields: window[process.env.VUE_APP_NAME].STORE.form.inputs.forEach(function(el ){\n  //     return {\n  //       name: el.name,\n  //       value: null\n  //     };\n  // }),\n\n  // editedItem: window[process.env.VUE_APP_NAME].STORE.form.inputs.reduce( (a,c) => (a[c.name] = c.default ?? '', a), {}),\n  // editedItem: Object.keys(window[process.env.VUE_APP_NAME].STORE.form.inputs).reduce( (a,c) => (a[window[process.env.VUE_APP_NAME].STORE.form.inputs[c].name] = window[process.env.VUE_APP_NAME].STORE.form.inputs[c].hasOwnProperty('default') ? window[process.env.VUE_APP_NAME].STORE.form.inputs[c].default : '', a), {}),\n  editedItem: getSchemaModel(window[process.env.VUE_APP_NAME].STORE.form.inputs),\n\n  /**\n   * Force reload on successful submit\n   * @type {Boolean}\n   */\n  reloadOnSuccess: window[process.env.VUE_APP_NAME].STORE.form.reloadOnSuccess || false,\n\n  /**\n   * Determines if the form should prevent submitting before an input value is pushed into the store\n   * @type {Boolean}\n   */\n  isSubmitPrevented: false,\n\n  loading: false\n}\n\n// getters\nconst getters = {\n  defaultItem: state => {\n    // __log(state.editedItem)\n    return state.editedItem\n    // return state.inputs.reduce( (a,c) => (a[c.name] = c.hasOwnProperty('default') ? c.default : '', a), {})\n  }\n}\n\nconst mutations = {\n  [FORM.SET_EDITED_ITEM] (state, item) {\n    state.editedItem = Object.assign({}, item)\n  },\n\n  [FORM.PREVENT_SUBMIT] (state) {\n    state.isSubmitPrevented = true\n  },\n  [FORM.ALLOW_SUBMIT] (state) {\n    state.isSubmitPrevented = false\n  },\n  // ----------- Form fields ----------- //\n  [FORM.EMPTY_FORM_FIELDS] (state, status) {\n    state.fields = []\n  },\n  [FORM.ADD_FORM_FIELDS] (state, fields) {\n    state.fields = [...state.fields, ...fields]\n  },\n  [FORM.REPLACE_FORM_FIELDS] (state, fields) {\n    state.fields = fields\n  },\n  [FORM.UPDATE_FORM_FIELD] (state, field) {\n    let fieldValue = field.locale ? {} : null\n    const fieldIndex = getFieldIndex(state.fields, field)\n    // Update existing form field\n    if (fieldIndex !== -1) {\n      if (field.locale) fieldValue = state.fields[fieldIndex].value || {}\n      // remove existing field\n      state.fields.splice(fieldIndex, 1)\n    }\n\n    if (field.locale) fieldValue[field.locale] = field.value\n    else fieldValue = field.value\n\n    state.fields.push({\n      name: field.name,\n      value: fieldValue\n    })\n  },\n  [FORM.REMOVE_FORM_FIELD] (state, fieldName) {\n    state.fields.forEach(function (field, index) {\n      if (field.name === fieldName) state.fields.splice(index, 1)\n    })\n  },\n  // ----------- Modal fields ----------- //\n  [FORM.EMPTY_MODAL_FIELDS] (state, status) {\n    state.modalFields = []\n  },\n  [FORM.REPLACE_MODAL_FIELDS] (state, fields) {\n    state.modalFields = fields\n  },\n  [FORM.UPDATE_MODAL_FIELD] (state, field) {\n    let fieldValue = field.locale ? {} : null\n    const fieldIndex = getFieldIndex(state.modalFields, field)\n\n    // Update existing form field\n    if (fieldIndex !== -1) {\n      if (field.locale) fieldValue = state.modalFields[fieldIndex].value\n      // remove existing field\n      state.modalFields.splice(fieldIndex, 1)\n    }\n\n    if (field.locale) fieldValue[field.locale] = field.value\n    else fieldValue = field.value\n\n    state.modalFields.push({\n      name: field.name,\n      value: fieldValue\n    })\n  },\n  [FORM.REMOVE_MODAL_FIELD] (state, fieldName) {\n    state.modalFields.forEach(function (field, index) {\n      if (field.name === fieldName) state.modalFields.splice(index, 1)\n    })\n  },\n  // ----------- Form errors and Loading ----------- //\n  [FORM.UPDATE_FORM_LOADING] (state, loading) {\n    state.loading = loading || !state.loading\n  },\n  [FORM.SET_FORM_ERRORS] (state, errors) {\n    state.errors = errors\n  },\n  [FORM.CLEAR_FORM_ERRORS] (state) {\n    state.errors = []\n  },\n  [FORM.UPDATE_FORM_SAVE_TYPE] (state, type) {\n    state.type = type\n  }\n}\n\nconst actions = {\n  [ACTIONS.SAVE_FORM] ({ commit, state, getters, rootState, dispatch }, { item = null, callback = null, errorCallback = null }) {\n    commit(FORM.CLEAR_FORM_ERRORS)\n    commit(FORM.UPDATE_FORM_LOADING, true)\n\n    // commit(NOTIFICATION.CLEAR_NOTIF, 'error')\n\n    // update or create etc...\n    // commit(FORM.UPDATE_FORM_SAVE_TYPE, saveType)\n\n    // we can now create our submitted data object out of:\n    // - our just created fields object,\n    // - publication properties\n    // - selected medias and browsers\n    // - created blocks and repeaters\n\n    // const data = getFormData(rootState)\n    const data = item ?? state.editedItem\n\n    // const method = rootState.publication.createWithoutModal ? 'post' : 'put'\n    let method = 'post'\n    let url = window[process.env.VUE_APP_NAME].ENDPOINTS.store\n\n    if (data.hasOwnProperty('id')) {\n      method = 'put'\n      url = window[process.env.VUE_APP_NAME].ENDPOINTS.update.replace(':id', data.id)\n    }\n\n    api[method](url, data, function (response) {\n      commit(FORM.UPDATE_FORM_LOADING, false)\n      // __log(\n      //   response\n      // )\n      // if (successResponse.data.hasOwnProperty('redirect')) {\n      //   window.location.replace(successResponse.data.redirect)\n      // }\n\n      // if (state.reloadOnSuccess) {\n      //   window.location.reload()\n      // }\n\n      // commit(PUBLICATION.UPDATE_PUBLISH_SUBMIT)\n      // if (successResponse.data.hasOwnProperty('revisions')) {\n      //   commit(REVISION.UPDATE_REV_ALL, successResponse.data.revisions)\n      // }\n      // __log(reload)\n      if (response.data.hasOwnProperty('errors')) {\n        commit(FORM.SET_FORM_ERRORS, response.data.errors)\n      } else if (response.data.hasOwnProperty('variant') && response.data.variant == 'success') {\n        commit(ALERT.SET_ALERT, { message: response.data.message, variant: response.data.variant })\n\n        if (!data.hasOwnProperty('reload') || data.reload) { dispatch(ACTIONS.GET_DATATABLE) }\n      }\n\n      if (callback && typeof callback === 'function') callback(response.data)\n    }, function (errorResponse) {\n      commit(FORM.UPDATE_FORM_LOADING, false)\n\n      if (errorResponse.response.data.hasOwnProperty('exception')) {\n        commit(ALERT.SET_ALERT, { message: 'Your submission could not be processed.', variant: 'error' })\n      } else {\n        dispatch(ACTIONS.HANDLE_ERRORS, errorResponse.response.data)\n        commit(ALERT.SET_ALERT, { message: 'Your submission could not be validated, please fix and retry', variant: 'error' })\n      }\n\n      if (errorCallback && typeof errorCallback === 'function') errorCallback(errorResponse.data)\n    })\n  },\n\n  [ACTIONS.HANDLE_ERRORS] ({ commit, state, getters, rootState }, errors) {\n    const repeaters = rootState.repeaters\n    // Translate the errors to their respective fields.\n    Object.keys(errors).forEach((errorKey) => {\n      const splitted = errorKey.split('.')\n\n      if (splitted.length >= 4) {\n        const type = splitted[0]\n        const subType = splitted[1]\n        const index = splitted[2]\n        const field = splitted[3]\n\n        if (type === 'repeaters') {\n          const id = repeaters[subType][index].id\n          const newErrorKey = `blocks[${id}][${field}]`\n          errors[newErrorKey] = errors[errorKey]\n        }\n      }\n    })\n\n    commit(FORM.SET_FORM_ERRORS, errors)\n  }\n}\n\nexport default {\n  state,\n  getters,\n  actions,\n  mutations\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}