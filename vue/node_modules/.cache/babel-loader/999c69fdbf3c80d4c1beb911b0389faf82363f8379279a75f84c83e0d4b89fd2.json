{"ast":null,"code":"import _objectSpread from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport { mapState, mapGetters } from 'vuex';\nimport { DATATABLE, FORM } from '@/store/mutations/index';\nimport ACTIONS from '@/store/actions';\nexport default {\n  props: {\n    name: {\n      type: String,\n      \"default\": 'Item'\n    },\n    titleKey: {\n      type: String,\n      \"default\": 'name'\n    },\n    hideDefaultHeader: Boolean,\n    hideDefaultFooter: Boolean,\n    isRowEditing: Boolean,\n    createOnModal: Boolean,\n    editOnModal: Boolean\n    // tableOptions: {\n    //   type: Object,\n    //   default() {\n    //     return {\n    //       page: 1,\n    //       itemsPerPage: 5,\n    //       sortBy: [],\n    //       sortDesc: [],\n    //       groupBy: [],\n    //       groupDesc: [],\n    //       multiSort: false,\n    //       mustSort: false\n    //     }\n    //   }\n    // },\n  },\n\n  data: function data() {\n    return {\n      editedIndex: -1,\n      createUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.create,\n      editUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.edit,\n      selectedItems: []\n    };\n  },\n  watch: {\n    editedItem: function editedItem(val) {\n      this.editedIndex = this.elements.findIndex(function (o) {\n        return o.id === val.id;\n      });\n    },\n    selectedItems: function selectedItems(val) {\n      __log('selectedItems watch', val);\n    }\n  },\n  computed: _objectSpread(_objectSpread({\n    formTitle: function formTitle() {\n      return this.$t(this.editedIndex === -1 ? 'new-item' : 'edit-item', {\n        item: this.name\n      });\n      return this.editedIndex === -1 ? \"New \".concat(this.name) : \"Edit \".concat(this.name);\n    },\n    options: {\n      get: function get() {\n        // console.log(\n        //   this.$store.state.datatable.options\n        // )\n        return this.$store.state.datatable.options;\n      },\n      set: function set(value) {\n        // __log('options set', value)\n        this.$store.dispatch(ACTIONS.GET_DATATABLE, {\n          payload: {\n            options: value\n          }\n        });\n        // this.$store.commit(DATATABLE.UPDATE_DATATABLE_OPTIONS, value)\n      }\n    },\n\n    search: {\n      get: function get() {\n        return this.$store.state.datatable.search;\n      },\n      set: function set(val) {\n        this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, val);\n        this.$store.dispatch(ACTIONS.GET_DATATABLE);\n      }\n    }\n  }, mapState({\n    // datatable module\n    headers: function headers(state) {\n      return state.datatable.headers;\n    },\n    loading: function loading(state) {\n      return state.datatable.loading;\n    },\n    elements: function elements(state) {\n      return state.datatable.data;\n    },\n    // form module\n    inputs: function inputs(state) {\n      return state.form.inputs;\n    },\n    editedItem: function editedItem(state) {\n      return state.form.editedItem;\n    },\n    formLoading: function formLoading(state) {\n      return state.form.loading;\n    },\n    formErrors: function formErrors(state) {\n      return state.form.errors;\n    }\n  })), mapGetters([\n  // datatable module\n  'totalElements', 'formatterColumns', 'editableColumns', 'rowEditables', 'rowActionsType', 'rowActions', 'mainFilters',\n  // form module\n  'defaultItem'])),\n  methods: {\n    handleFunctionCall: function handleFunctionCall(functionName) {\n      for (var _len = arguments.length, val = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        val[_key - 1] = arguments[_key];\n      }\n      return this[functionName].apply(this, val);\n    },\n    initialize: function initialize() {\n      this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, '');\n      this.$store.commit(DATATABLE.UPDATE_DATATABLE_OPTIONS, window[process.env.VUE_APP_NAME].STORE.datatable.options);\n      this.$store.dispatch(ACTIONS.GET_DATATABLE);\n    },\n    editItem: function editItem(item) {\n      if (this.editOnModal) {\n        this.setEditedItem(item);\n        this.$refs.formModal.openModal();\n      } else {\n        var route = this.editUrl.replace(':id', item.id);\n        window.open(route);\n      }\n    },\n    deleteItem: function deleteItem(item) {\n      this.setEditedItem(item);\n      this.$refs.dialog.openModal();\n    },\n    formatDate: function formatDate(value) {\n      __log(value);\n      return this.$d(new Date(value), 'long');\n      return new Date(value).toLocaleString();\n    },\n    setEditedItem: function setEditedItem(item) {\n      this.$store.commit(FORM.SET_EDITED_ITEM, item);\n    },\n    resetEditedItem: function resetEditedItem() {\n      var _this = this;\n      this.$nextTick(function () {\n        _this.$store.commit(FORM.SET_EDITED_ITEM, _this.defaultItem);\n      });\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapGetters","DATATABLE","FORM","ACTIONS","props","name","type","String","titleKey","hideDefaultHeader","Boolean","hideDefaultFooter","isRowEditing","createOnModal","editOnModal","data","editedIndex","createUrl","window","process","env","VUE_APP_NAME","ENDPOINTS","create","editUrl","edit","selectedItems","watch","editedItem","val","elements","findIndex","o","id","__log","computed","_objectSpread","formTitle","$t","item","concat","options","get","$store","state","datatable","set","value","dispatch","GET_DATATABLE","payload","search","commit","UPDATE_DATATABLE_SEARCH","headers","loading","inputs","form","formLoading","formErrors","errors","methods","handleFunctionCall","functionName","_len","arguments","length","Array","_key","apply","initialize","UPDATE_DATATABLE_OPTIONS","STORE","editItem","setEditedItem","$refs","formModal","openModal","route","replace","open","deleteItem","dialog","formatDate","$d","Date","toLocaleString","SET_EDITED_ITEM","resetEditedItem","_this","$nextTick","defaultItem"],"sources":["/var/www/crm_template/packages/oobook/crm-base/vue/src/js/mixins/datatable.js"],"sourcesContent":["import { mapState, mapGetters } from 'vuex'\nimport { DATATABLE, FORM } from '@/store/mutations/index'\nimport ACTIONS from '@/store/actions'\n\nexport default {\n  props: {\n    name: {\n      type: String,\n      default: 'Item'\n    },\n    titleKey: {\n      type: String,\n      default: 'name'\n    },\n    hideDefaultHeader: Boolean,\n    hideDefaultFooter: Boolean,\n    isRowEditing: Boolean,\n    createOnModal: Boolean,\n    editOnModal: Boolean\n    // tableOptions: {\n    //   type: Object,\n    //   default() {\n    //     return {\n    //       page: 1,\n    //       itemsPerPage: 5,\n    //       sortBy: [],\n    //       sortDesc: [],\n    //       groupBy: [],\n    //       groupDesc: [],\n    //       multiSort: false,\n    //       mustSort: false\n    //     }\n    //   }\n    // },\n  },\n  data: function () {\n    return {\n      editedIndex: -1,\n      createUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.create,\n      editUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.edit,\n\n      selectedItems: []\n    }\n  },\n  watch: {\n    editedItem (val) {\n      this.editedIndex = this.elements.findIndex(o => { return o.id === val.id })\n    },\n    selectedItems (val) {\n      __log('selectedItems watch', val)\n    }\n  },\n  computed: {\n    formTitle () {\n      return this.$t((this.editedIndex === -1 ? 'new-item' : 'edit-item'), { item: this.name })\n      return this.editedIndex === -1 ? `New ${this.name}` : `Edit ${this.name}`\n    },\n    options: {\n      get () {\n        // console.log(\n        //   this.$store.state.datatable.options\n        // )\n        return this.$store.state.datatable.options\n      },\n      set (value) {\n        // __log('options set', value)\n        this.$store.dispatch(ACTIONS.GET_DATATABLE, { payload: { options: value } })\n        // this.$store.commit(DATATABLE.UPDATE_DATATABLE_OPTIONS, value)\n      }\n    },\n    search: {\n      get () {\n        return this.$store.state.datatable.search\n      },\n      set (val) {\n        this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, val)\n        this.$store.dispatch(ACTIONS.GET_DATATABLE)\n      }\n    },\n    ...mapState({\n      // datatable module\n      headers: state => state.datatable.headers,\n      loading: state => state.datatable.loading,\n      elements: state => state.datatable.data,\n\n      // form module\n      inputs: state => state.form.inputs,\n      editedItem: state => state.form.editedItem,\n      formLoading: state => state.form.loading,\n      formErrors: state => state.form.errors\n    }),\n    ...mapGetters([\n      // datatable module\n      'totalElements',\n      'formatterColumns',\n      'editableColumns',\n      'rowEditables',\n      'rowActionsType',\n      'rowActions',\n      'mainFilters',\n\n      // form module\n      'defaultItem'\n    ])\n  },\n  methods: {\n    handleFunctionCall (functionName, ...val) {\n      return this[functionName](...val)\n    },\n    initialize () {\n      this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, '')\n      this.$store.commit(\n        DATATABLE.UPDATE_DATATABLE_OPTIONS,\n        window[process.env.VUE_APP_NAME].STORE.datatable.options\n      )\n      this.$store.dispatch(ACTIONS.GET_DATATABLE)\n    },\n    editItem (item) {\n      if (this.editOnModal) {\n        this.setEditedItem(item)\n        this.$refs.formModal.openModal()\n      } else {\n        const route = this.editUrl.replace(':id', item.id)\n        window.open(route)\n      }\n    },\n    deleteItem (item) {\n      this.setEditedItem(item)\n      this.$refs.dialog.openModal()\n    },\n    formatDate (value) {\n      __log(\n        value\n      )\n      return this.$d(new Date(value), 'long')\n      return new Date(value).toLocaleString()\n    },\n\n    setEditedItem (item) {\n      this.$store.commit(FORM.SET_EDITED_ITEM, item)\n    },\n    resetEditedItem () {\n      this.$nextTick(() => {\n        this.$store.commit(FORM.SET_EDITED_ITEM, this.defaultItem)\n      })\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}