{"ast":null,"code":"import _objectSpread from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.is-array.js\";\nimport \"core-js/modules/es.array.every.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.ends-with.js\";\nimport { createVNode as _createVNode } from \"vue\";\n// Styles\nimport \"./VColorPicker.css\";\n\n// Components\nimport { VColorPickerCanvas } from \"./VColorPickerCanvas.mjs\";\nimport { VColorPickerEdit } from \"./VColorPickerEdit.mjs\";\nimport { VColorPickerPreview } from \"./VColorPickerPreview.mjs\";\nimport { VColorPickerSwatches } from \"./VColorPickerSwatches.mjs\";\nimport { VSheet } from \"../VSheet/index.mjs\"; // Composables\nimport { makeElevationProps } from \"../../composables/elevation.mjs\";\nimport { makeRoundedProps } from \"../../composables/rounded.mjs\";\nimport { makeThemeProps } from \"../../composables/theme.mjs\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\";\nimport { provideDefaults } from \"../../composables/defaults.mjs\"; // Utilities\nimport { defineComponent, HSVtoCSS, useRender } from \"../../util/index.mjs\";\nimport { extractColor, modes, nullColor, parseColor } from \"./util/index.mjs\";\nimport { onMounted, ref } from 'vue';\n\n// Types\n\nexport var VColorPicker = defineComponent({\n  name: 'VColorPicker',\n  props: _objectSpread(_objectSpread(_objectSpread({\n    canvasHeight: {\n      type: [String, Number],\n      \"default\": 150\n    },\n    disabled: Boolean,\n    dotSize: {\n      type: [Number, String],\n      \"default\": 10\n    },\n    hideCanvas: Boolean,\n    hideSliders: Boolean,\n    hideInputs: Boolean,\n    mode: {\n      type: String,\n      \"default\": 'rgba',\n      validator: function validator(v) {\n        return Object.keys(modes).includes(v);\n      }\n    },\n    modes: {\n      type: Array,\n      \"default\": function _default() {\n        return Object.keys(modes);\n      },\n      validator: function validator(v) {\n        return Array.isArray(v) && v.every(function (m) {\n          return Object.keys(modes).includes(m);\n        });\n      }\n    },\n    showSwatches: Boolean,\n    swatches: Array,\n    swatchesMaxHeight: {\n      type: [Number, String],\n      \"default\": 150\n    },\n    modelValue: {\n      type: [Object, String]\n    },\n    width: {\n      type: [Number, String],\n      \"default\": 300\n    }\n  }, makeElevationProps()), makeRoundedProps()), makeThemeProps()),\n  emits: {\n    'update:modelValue': function updateModelValue(color) {\n      return true;\n    },\n    'update:mode': function updateMode(mode) {\n      return true;\n    }\n  },\n  setup: function setup(props) {\n    var mode = useProxiedModel(props, 'mode');\n    var lastPickedColor = ref(null);\n    var currentColor = useProxiedModel(props, 'modelValue', undefined, function (v) {\n      var c = parseColor(v);\n      if (!c) return null;\n      if (lastPickedColor.value) {\n        c = _objectSpread(_objectSpread({}, c), {}, {\n          h: lastPickedColor.value.h\n        });\n        lastPickedColor.value = null;\n      }\n      return c;\n    }, function (v) {\n      if (!v) return null;\n      return extractColor(v, props.modelValue);\n    });\n    var updateColor = function updateColor(hsva) {\n      currentColor.value = hsva;\n      lastPickedColor.value = hsva;\n    };\n    onMounted(function () {\n      if (!props.modes.includes(mode.value)) mode.value = props.modes[0];\n    });\n    provideDefaults({\n      VSlider: {\n        color: undefined,\n        trackColor: undefined,\n        trackFillColor: undefined\n      }\n    });\n    useRender(function () {\n      var _currentColor$value;\n      return _createVNode(VSheet, {\n        \"rounded\": props.rounded,\n        \"elevation\": props.elevation,\n        \"theme\": props.theme,\n        \"class\": ['v-color-picker'],\n        \"style\": {\n          '--v-color-picker-color-hsv': HSVtoCSS(_objectSpread(_objectSpread({}, (_currentColor$value = currentColor.value) !== null && _currentColor$value !== void 0 ? _currentColor$value : nullColor), {}, {\n            a: 1\n          }))\n        },\n        \"maxWidth\": props.width\n      }, {\n        \"default\": function _default() {\n          return [!props.hideCanvas && _createVNode(VColorPickerCanvas, {\n            \"key\": \"canvas\",\n            \"color\": currentColor.value,\n            \"onUpdate:color\": updateColor,\n            \"disabled\": props.disabled,\n            \"dotSize\": props.dotSize,\n            \"width\": props.width,\n            \"height\": props.canvasHeight\n          }, null), (!props.hideSliders || !props.hideInputs) && _createVNode(\"div\", {\n            \"key\": \"controls\",\n            \"class\": \"v-color-picker__controls\"\n          }, [!props.hideSliders && _createVNode(VColorPickerPreview, {\n            \"key\": \"preview\",\n            \"color\": currentColor.value,\n            \"onUpdate:color\": updateColor,\n            \"hideAlpha\": !mode.value.endsWith('a'),\n            \"disabled\": props.disabled\n          }, null), !props.hideInputs && _createVNode(VColorPickerEdit, {\n            \"key\": \"edit\",\n            \"modes\": props.modes,\n            \"mode\": mode.value,\n            \"onUpdate:mode\": function onUpdateMode(m) {\n              return mode.value = m;\n            },\n            \"color\": currentColor.value,\n            \"onUpdate:color\": updateColor,\n            \"disabled\": props.disabled\n          }, null)]), props.showSwatches && _createVNode(VColorPickerSwatches, {\n            \"key\": \"swatches\",\n            \"color\": currentColor.value,\n            \"onUpdate:color\": updateColor,\n            \"maxHeight\": props.swatchesMaxHeight,\n            \"swatches\": props.swatches,\n            \"disabled\": props.disabled\n          }, null)];\n        }\n      });\n    });\n    return {};\n  }\n});","map":{"version":3,"names":["VColorPickerCanvas","VColorPickerEdit","VColorPickerPreview","VColorPickerSwatches","VSheet","makeElevationProps","makeRoundedProps","makeThemeProps","useProxiedModel","provideDefaults","defineComponent","HSVtoCSS","useRender","extractColor","modes","nullColor","parseColor","onMounted","ref","VColorPicker","name","props","_objectSpread","canvasHeight","type","String","Number","disabled","Boolean","dotSize","hideCanvas","hideSliders","hideInputs","mode","validator","v","Object","keys","includes","Array","_default","isArray","every","m","showSwatches","swatches","swatchesMaxHeight","modelValue","width","emits","updateModelValue","color","updateMode","setup","lastPickedColor","currentColor","undefined","c","value","h","updateColor","hsva","VSlider","trackColor","trackFillColor","_currentColor$value","_createVNode","rounded","elevation","theme","a","endsWith","onUpdateMode"],"sources":["../../../src/components/VColorPicker/VColorPicker.tsx"],"sourcesContent":["// Styles\nimport './VColorPicker.sass'\n\n// Components\nimport { VColorPickerCanvas } from './VColorPickerCanvas'\nimport { VColorPickerEdit } from './VColorPickerEdit'\nimport { VColorPickerPreview } from './VColorPickerPreview'\nimport { VColorPickerSwatches } from './VColorPickerSwatches'\nimport { VSheet } from '@/components/VSheet'\n\n// Composables\nimport { makeElevationProps } from '@/composables/elevation'\nimport { makeRoundedProps } from '@/composables/rounded'\nimport { makeThemeProps } from '@/composables/theme'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { provideDefaults } from '@/composables/defaults'\n\n// Utilities\nimport { defineComponent, HSVtoCSS, useRender } from '@/util'\nimport { extractColor, modes, nullColor, parseColor } from './util'\nimport { onMounted, ref } from 'vue'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { HSV } from '@/util'\n\nexport const VColorPicker = defineComponent({\n  name: 'VColorPicker',\n\n  props: {\n    canvasHeight: {\n      type: [String, Number],\n      default: 150,\n    },\n    disabled: Boolean,\n    dotSize: {\n      type: [Number, String],\n      default: 10,\n    },\n    hideCanvas: Boolean,\n    hideSliders: Boolean,\n    hideInputs: Boolean,\n    mode: {\n      type: String,\n      default: 'rgba',\n      validator: (v: string) => Object.keys(modes).includes(v),\n    },\n    modes: {\n      type: Array as PropType<string[]>,\n      default: () => Object.keys(modes),\n      validator: (v: any) => Array.isArray(v) && v.every(m => Object.keys(modes).includes(m)),\n    },\n    showSwatches: Boolean,\n    swatches: Array as PropType<string[][]>,\n    swatchesMaxHeight: {\n      type: [Number, String],\n      default: 150,\n    },\n    modelValue: {\n      type: [Object, String] as PropType<Record<string, unknown> | string | undefined | null>,\n    },\n    width: {\n      type: [Number, String],\n      default: 300,\n    },\n\n    ...makeElevationProps(),\n    ...makeRoundedProps(),\n    ...makeThemeProps(),\n  },\n\n  emits: {\n    'update:modelValue': (color: any) => true,\n    'update:mode': (mode: string) => true,\n  },\n\n  setup (props) {\n    const mode = useProxiedModel(props, 'mode')\n    const lastPickedColor = ref<HSV | null>(null)\n    const currentColor = useProxiedModel(\n      props,\n      'modelValue',\n      undefined,\n      v => {\n        let c = parseColor(v)\n\n        if (!c) return null\n\n        if (lastPickedColor.value) {\n          c = { ...c, h: lastPickedColor.value.h }\n          lastPickedColor.value = null\n        }\n\n        return c\n      },\n      v => {\n        if (!v) return null\n\n        return extractColor(v, props.modelValue)\n      }\n    )\n\n    const updateColor = (hsva: HSV) => {\n      currentColor.value = hsva\n      lastPickedColor.value = hsva\n    }\n\n    onMounted(() => {\n      if (!props.modes.includes(mode.value)) mode.value = props.modes[0]\n    })\n\n    provideDefaults({\n      VSlider: {\n        color: undefined,\n        trackColor: undefined,\n        trackFillColor: undefined,\n      },\n    })\n\n    useRender(() => (\n      <VSheet\n        rounded={ props.rounded }\n        elevation={ props.elevation }\n        theme={ props.theme }\n        class={[\n          'v-color-picker',\n        ]}\n        style={{\n          '--v-color-picker-color-hsv': HSVtoCSS({ ...(currentColor.value ?? nullColor), a: 1 }),\n        }}\n        maxWidth={ props.width }\n      >\n        { !props.hideCanvas && (\n          <VColorPickerCanvas\n            key=\"canvas\"\n            color={ currentColor.value }\n            onUpdate:color={ updateColor }\n            disabled={ props.disabled }\n            dotSize={ props.dotSize }\n            width={ props.width }\n            height={ props.canvasHeight }\n          />\n        ) }\n\n        { (!props.hideSliders || !props.hideInputs) && (\n          <div key=\"controls\" class=\"v-color-picker__controls\">\n            { !props.hideSliders && (\n              <VColorPickerPreview\n                key=\"preview\"\n                color={ currentColor.value }\n                onUpdate:color={ updateColor }\n                hideAlpha={ !mode.value.endsWith('a') }\n                disabled={ props.disabled }\n              />\n            ) }\n\n            { !props.hideInputs && (\n              <VColorPickerEdit\n                key=\"edit\"\n                modes={ props.modes }\n                mode={ mode.value }\n                onUpdate:mode={ m => mode.value = m }\n                color={ currentColor.value }\n                onUpdate:color={ updateColor }\n                disabled={ props.disabled }\n              />\n            ) }\n          </div>\n        ) }\n\n        { props.showSwatches && (\n          <VColorPickerSwatches\n            key=\"swatches\"\n            color={ currentColor.value }\n            onUpdate:color={ updateColor }\n            maxHeight={ props.swatchesMaxHeight }\n            swatches={ props.swatches }\n            disabled={ props.disabled }\n          />\n        ) }\n      </VSheet>\n    ))\n\n    return {}\n  },\n})\n\nexport type VColorPicker = InstanceType<typeof VColorPicker>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}