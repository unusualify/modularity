{"ast":null,"code":"import _objectSpread from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.object.create.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n// Types\n// Utilities\nimport { keys } from \"../../util/index.mjs\";\nvar handleGesture = function handleGesture(wrapper) {\n  var touchstartX = wrapper.touchstartX,\n    touchendX = wrapper.touchendX,\n    touchstartY = wrapper.touchstartY,\n    touchendY = wrapper.touchendY;\n  var dirRatio = 0.5;\n  var minDistance = 16;\n  wrapper.offsetX = touchendX - touchstartX;\n  wrapper.offsetY = touchendY - touchstartY;\n  if (Math.abs(wrapper.offsetY) < dirRatio * Math.abs(wrapper.offsetX)) {\n    wrapper.left && touchendX < touchstartX - minDistance && wrapper.left(wrapper);\n    wrapper.right && touchendX > touchstartX + minDistance && wrapper.right(wrapper);\n  }\n  if (Math.abs(wrapper.offsetX) < dirRatio * Math.abs(wrapper.offsetY)) {\n    wrapper.up && touchendY < touchstartY - minDistance && wrapper.up(wrapper);\n    wrapper.down && touchendY > touchstartY + minDistance && wrapper.down(wrapper);\n  }\n};\nfunction _touchstart(event, wrapper) {\n  var _wrapper$start;\n  var touch = event.changedTouches[0];\n  wrapper.touchstartX = touch.clientX;\n  wrapper.touchstartY = touch.clientY;\n  (_wrapper$start = wrapper.start) === null || _wrapper$start === void 0 ? void 0 : _wrapper$start.call(wrapper, _objectSpread({\n    originalEvent: event\n  }, wrapper));\n}\nfunction _touchend(event, wrapper) {\n  var _wrapper$end;\n  var touch = event.changedTouches[0];\n  wrapper.touchendX = touch.clientX;\n  wrapper.touchendY = touch.clientY;\n  (_wrapper$end = wrapper.end) === null || _wrapper$end === void 0 ? void 0 : _wrapper$end.call(wrapper, _objectSpread({\n    originalEvent: event\n  }, wrapper));\n  handleGesture(wrapper);\n}\nfunction _touchmove(event, wrapper) {\n  var _wrapper$move;\n  var touch = event.changedTouches[0];\n  wrapper.touchmoveX = touch.clientX;\n  wrapper.touchmoveY = touch.clientY;\n  (_wrapper$move = wrapper.move) === null || _wrapper$move === void 0 ? void 0 : _wrapper$move.call(wrapper, _objectSpread({\n    originalEvent: event\n  }, wrapper));\n}\nfunction createHandlers() {\n  var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var wrapper = {\n    touchstartX: 0,\n    touchstartY: 0,\n    touchendX: 0,\n    touchendY: 0,\n    touchmoveX: 0,\n    touchmoveY: 0,\n    offsetX: 0,\n    offsetY: 0,\n    left: value.left,\n    right: value.right,\n    up: value.up,\n    down: value.down,\n    start: value.start,\n    move: value.move,\n    end: value.end\n  };\n  return {\n    touchstart: function touchstart(e) {\n      return _touchstart(e, wrapper);\n    },\n    touchend: function touchend(e) {\n      return _touchend(e, wrapper);\n    },\n    touchmove: function touchmove(e) {\n      return _touchmove(e, wrapper);\n    }\n  };\n}\nfunction mounted(el, binding) {\n  var _value$options, _binding$instance, _target$_touchHandler;\n  var value = binding.value;\n  var target = value !== null && value !== void 0 && value.parent ? el.parentElement : el;\n  var options = (_value$options = value === null || value === void 0 ? void 0 : value.options) !== null && _value$options !== void 0 ? _value$options : {\n    passive: true\n  };\n  var uid = (_binding$instance = binding.instance) === null || _binding$instance === void 0 ? void 0 : _binding$instance.$.uid; // TODO: use custom uid generator\n\n  if (!target || !uid) return;\n  var handlers = createHandlers(binding.value);\n  target._touchHandlers = (_target$_touchHandler = target._touchHandlers) !== null && _target$_touchHandler !== void 0 ? _target$_touchHandler : Object.create(null);\n  target._touchHandlers[uid] = handlers;\n  keys(handlers).forEach(function (eventName) {\n    target.addEventListener(eventName, handlers[eventName], options);\n  });\n}\nfunction unmounted(el, binding) {\n  var _binding$value, _binding$instance2;\n  var target = (_binding$value = binding.value) !== null && _binding$value !== void 0 && _binding$value.parent ? el.parentElement : el;\n  var uid = (_binding$instance2 = binding.instance) === null || _binding$instance2 === void 0 ? void 0 : _binding$instance2.$.uid;\n  if (!(target !== null && target !== void 0 && target._touchHandlers) || !uid) return;\n  var handlers = target._touchHandlers[uid];\n  keys(handlers).forEach(function (eventName) {\n    target.removeEventListener(eventName, handlers[eventName]);\n  });\n  delete target._touchHandlers[uid];\n}\nexport var Touch = {\n  mounted: mounted,\n  unmounted: unmounted\n};\nexport default Touch;","map":{"version":3,"names":["keys","handleGesture","wrapper","touchstartX","touchendX","touchstartY","touchendY","dirRatio","minDistance","offsetX","offsetY","Math","abs","left","right","up","down","touchstart","event","_wrapper$start","touch","changedTouches","clientX","clientY","start","call","_objectSpread","originalEvent","touchend","_wrapper$end","end","touchmove","_wrapper$move","touchmoveX","touchmoveY","move","createHandlers","value","arguments","length","undefined","e","mounted","el","binding","_value$options","_binding$instance","_target$_touchHandler","target","parent","parentElement","options","passive","uid","instance","$","handlers","_touchHandlers","Object","create","forEach","eventName","addEventListener","unmounted","_binding$value","_binding$instance2","removeEventListener","Touch"],"sources":["../../../src/directives/touch/index.ts"],"sourcesContent":["// Types\nimport type {\n  DirectiveBinding,\n} from 'vue'\n\n// Utilities\nimport { keys } from '@/util'\n\nexport interface TouchHandlers {\n  start?: (wrapperEvent: { originalEvent: TouchEvent } & TouchData) => void\n  end?: (wrapperEvent: { originalEvent: TouchEvent } & TouchData) => void\n  move?: (wrapperEvent: { originalEvent: TouchEvent } & TouchData) => void\n  left?: (wrapper: TouchData) => void\n  right?: (wrapper: TouchData) => void\n  up?: (wrapper: TouchData) => void\n  down?: (wrapper: TouchData) => void\n}\n\nexport interface TouchData {\n  touchstartX: number\n  touchstartY: number\n  touchmoveX: number\n  touchmoveY: number\n  touchendX: number\n  touchendY: number\n  offsetX: number\n  offsetY: number\n}\n\nexport type TouchWrapper = TouchHandlers & TouchData\n\nexport interface TouchValue extends TouchHandlers {\n  parent?: boolean\n  options?: AddEventListenerOptions\n}\n\nexport interface TouchStoredHandlers {\n  touchstart: (e: TouchEvent) => void\n  touchend: (e: TouchEvent) => void\n  touchmove: (e: TouchEvent) => void\n}\n\nexport interface TouchDirectiveBinding extends Omit<DirectiveBinding, 'value'> {\n  value?: TouchValue\n}\n\nconst handleGesture = (wrapper: TouchWrapper) => {\n  const { touchstartX, touchendX, touchstartY, touchendY } = wrapper\n  const dirRatio = 0.5\n  const minDistance = 16\n  wrapper.offsetX = touchendX - touchstartX\n  wrapper.offsetY = touchendY - touchstartY\n\n  if (Math.abs(wrapper.offsetY) < dirRatio * Math.abs(wrapper.offsetX)) {\n    wrapper.left && (touchendX < touchstartX - minDistance) && wrapper.left(wrapper)\n    wrapper.right && (touchendX > touchstartX + minDistance) && wrapper.right(wrapper)\n  }\n\n  if (Math.abs(wrapper.offsetX) < dirRatio * Math.abs(wrapper.offsetY)) {\n    wrapper.up && (touchendY < touchstartY - minDistance) && wrapper.up(wrapper)\n    wrapper.down && (touchendY > touchstartY + minDistance) && wrapper.down(wrapper)\n  }\n}\n\nfunction touchstart (event: TouchEvent, wrapper: TouchWrapper) {\n  const touch = event.changedTouches[0]\n  wrapper.touchstartX = touch.clientX\n  wrapper.touchstartY = touch.clientY\n\n  wrapper.start?.({ originalEvent: event, ...wrapper })\n}\n\nfunction touchend (event: TouchEvent, wrapper: TouchWrapper) {\n  const touch = event.changedTouches[0]\n  wrapper.touchendX = touch.clientX\n  wrapper.touchendY = touch.clientY\n\n  wrapper.end?.({ originalEvent: event, ...wrapper })\n\n  handleGesture(wrapper)\n}\n\nfunction touchmove (event: TouchEvent, wrapper: TouchWrapper) {\n  const touch = event.changedTouches[0]\n  wrapper.touchmoveX = touch.clientX\n  wrapper.touchmoveY = touch.clientY\n\n  wrapper.move?.({ originalEvent: event, ...wrapper })\n}\n\nfunction createHandlers (value: TouchHandlers = {}): TouchStoredHandlers {\n  const wrapper = {\n    touchstartX: 0,\n    touchstartY: 0,\n    touchendX: 0,\n    touchendY: 0,\n    touchmoveX: 0,\n    touchmoveY: 0,\n    offsetX: 0,\n    offsetY: 0,\n    left: value.left,\n    right: value.right,\n    up: value.up,\n    down: value.down,\n    start: value.start,\n    move: value.move,\n    end: value.end,\n  }\n\n  return {\n    touchstart: (e: TouchEvent) => touchstart(e, wrapper),\n    touchend: (e: TouchEvent) => touchend(e, wrapper),\n    touchmove: (e: TouchEvent) => touchmove(e, wrapper),\n  }\n}\n\nfunction mounted (el: HTMLElement, binding: TouchDirectiveBinding) {\n  const value = binding.value\n  const target = value?.parent ? el.parentElement : el\n  const options = value?.options ?? { passive: true }\n  const uid = binding.instance?.$.uid // TODO: use custom uid generator\n\n  if (!target || !uid) return\n\n  const handlers = createHandlers(binding.value)\n\n  target._touchHandlers = target._touchHandlers ?? Object.create(null)\n  target._touchHandlers![uid] = handlers\n\n  keys(handlers).forEach(eventName => {\n    target.addEventListener(eventName, handlers[eventName], options)\n  })\n}\n\nfunction unmounted (el: HTMLElement, binding: TouchDirectiveBinding) {\n  const target = binding.value?.parent ? el.parentElement : el\n  const uid = binding.instance?.$.uid\n\n  if (!target?._touchHandlers || !uid) return\n\n  const handlers = target._touchHandlers[uid]\n\n  keys(handlers).forEach(eventName => {\n    target.removeEventListener(eventName, handlers[eventName])\n  })\n\n  delete target._touchHandlers[uid]\n}\n\nexport const Touch = {\n  mounted,\n  unmounted,\n}\n\nexport default Touch\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}