{"ast":null,"code":"import { mapState, mapGetters } from 'vuex';\nimport { DATATABLE, FORM } from '@/store/mutations/index';\nimport ACTIONS from '@/store/actions';\nexport default {\n  props: {\n    name: {\n      type: String,\n      default: 'Item'\n    },\n    titleKey: {\n      type: String,\n      default: 'name'\n    },\n    hideDefaultHeader: Boolean,\n    hideDefaultFooter: Boolean,\n    isRowEditing: Boolean,\n    createOnModal: Boolean,\n    editOnModal: Boolean\n    // tableOptions: {\n    //   type: Object,\n    //   default() {\n    //     return {\n    //       page: 1,\n    //       itemsPerPage: 5,\n    //       sortBy: [],\n    //       sortDesc: [],\n    //       groupBy: [],\n    //       groupDesc: [],\n    //       multiSort: false,\n    //       mustSort: false\n    //     }\n    //   }\n    // },\n  },\n\n  data: function () {\n    return {\n      editedIndex: -1,\n      createUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.create,\n      editUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.edit\n    };\n  },\n  watch: {\n    editedItem(val) {\n      this.editedIndex = this.elements.findIndex(o => {\n        return o.id === val.id;\n      });\n      // __log('editedIndex', this.editedIndex)\n    }\n  },\n\n  computed: {\n    formTitle() {\n      return this.$t(this.editedIndex === -1 ? 'new-item' : 'edit-item', {\n        item: this.name\n      });\n      return this.editedIndex === -1 ? `New ${this.name}` : `Edit ${this.name}`;\n    },\n    options: {\n      get() {\n        return this.$store.state.datatable.options;\n      },\n      set(value) {\n        // __log('options set', value)\n        this.$store.dispatch(ACTIONS.GET_DATATABLE, {\n          payload: {\n            options: value\n          }\n        });\n        // this.$store.commit(DATATABLE.UPDATE_DATATABLE_OPTIONS, value)\n      }\n    },\n\n    search: {\n      get() {\n        return this.$store.state.datatable.search;\n      },\n      set(val) {\n        this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, val);\n        this.$store.dispatch(ACTIONS.GET_DATATABLE);\n      }\n    },\n    ...mapState({\n      // datatable module\n      headers: state => state.datatable.headers,\n      loading: state => state.datatable.loading,\n      elements: state => state.datatable.data,\n      // form module\n      inputs: state => state.form.inputs,\n      editedItem: state => state.form.editedItem,\n      formLoading: state => state.form.loading,\n      formErrors: state => state.form.errors\n    }),\n    ...mapGetters([\n    // datatable module\n    'totalElements', 'formatterColumns', 'editableColumns', 'rowEditables', 'rowActionsType', 'rowActions', 'mainFilters',\n    // form module\n    'defaultItem'])\n  },\n  methods: {\n    handleFunctionCall(functionName, ...val) {\n      // __log(functionName)\n      return this[functionName](...val);\n    },\n    initialize() {\n      this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, '');\n      this.$store.commit(DATATABLE.UPDATE_DATATABLE_OPTIONS, window[process.env.VUE_APP_NAME].STORE.datatable.options);\n      this.$store.dispatch(ACTIONS.GET_DATATABLE);\n    },\n    editItem(item) {\n      if (this.editOnModal) {\n        this.setEditedItem(item);\n        this.$refs.formModal.openModal();\n      } else {\n        const route = this.editUrl.replace(':id', item.id);\n        window.open(route);\n      }\n    },\n    deleteItem(item) {\n      this.setEditedItem(item);\n      this.$refs.dialog.openModal();\n    },\n    formatDate(value) {\n      // __log(value)\n      return this.$d(new Date(value), 'long');\n      return new Date(value).toLocaleString();\n    },\n    setEditedItem(item) {\n      // this.editedIndex = this.elements.indexOf(item)\n      // this.editedItem = Object.assign({}, item)\n      this.$store.commit(FORM.SET_EDITED_ITEM, item);\n    },\n    resetEditedItem() {\n      this.$nextTick(() => {\n        // this.editedItem = Object.assign({}, this.defaultItem)\n        this.$store.commit(FORM.SET_EDITED_ITEM, this.defaultItem);\n        // this.editedIndex = -1\n      });\n    }\n  }\n};","map":{"version":3,"names":["mapState","mapGetters","DATATABLE","FORM","ACTIONS","props","name","type","String","default","titleKey","hideDefaultHeader","Boolean","hideDefaultFooter","isRowEditing","createOnModal","editOnModal","data","editedIndex","createUrl","window","process","env","VUE_APP_NAME","ENDPOINTS","create","editUrl","edit","watch","editedItem","val","elements","findIndex","o","id","computed","formTitle","$t","item","options","get","$store","state","datatable","set","value","dispatch","GET_DATATABLE","payload","search","commit","UPDATE_DATATABLE_SEARCH","headers","loading","inputs","form","formLoading","formErrors","errors","methods","handleFunctionCall","functionName","initialize","UPDATE_DATATABLE_OPTIONS","STORE","editItem","setEditedItem","$refs","formModal","openModal","route","replace","open","deleteItem","dialog","formatDate","$d","Date","toLocaleString","SET_EDITED_ITEM","resetEditedItem","$nextTick","defaultItem"],"sources":["/var/www/crm_template/packages/oobook/crm-base/vue/src/js/mixins/datatable.js"],"sourcesContent":["import { mapState, mapGetters } from 'vuex'\nimport { DATATABLE, FORM } from '@/store/mutations/index'\nimport ACTIONS from '@/store/actions'\n\nexport default {\n  props: {\n    name: {\n      type: String,\n      default: 'Item'\n    },\n    titleKey: {\n      type: String,\n      default: 'name'\n    },\n    hideDefaultHeader: Boolean,\n    hideDefaultFooter: Boolean,\n    isRowEditing: Boolean,\n    createOnModal: Boolean,\n    editOnModal: Boolean\n    // tableOptions: {\n    //   type: Object,\n    //   default() {\n    //     return {\n    //       page: 1,\n    //       itemsPerPage: 5,\n    //       sortBy: [],\n    //       sortDesc: [],\n    //       groupBy: [],\n    //       groupDesc: [],\n    //       multiSort: false,\n    //       mustSort: false\n    //     }\n    //   }\n    // },\n  },\n  data: function () {\n    return {\n      editedIndex: -1,\n      createUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.create,\n      editUrl: window[process.env.VUE_APP_NAME].ENDPOINTS.edit\n    }\n  },\n  watch: {\n    editedItem (val) {\n      this.editedIndex = this.elements.findIndex(o => { return o.id === val.id })\n      // __log('editedIndex', this.editedIndex)\n    }\n  },\n  computed: {\n    formTitle () {\n      return this.$t((this.editedIndex === -1 ? 'new-item' : 'edit-item'), { item: this.name })\n      return this.editedIndex === -1 ? `New ${this.name}` : `Edit ${this.name}`\n    },\n    options: {\n      get () {\n        return this.$store.state.datatable.options\n      },\n      set (value) {\n        // __log('options set', value)\n        this.$store.dispatch(ACTIONS.GET_DATATABLE, { payload: { options: value } })\n        // this.$store.commit(DATATABLE.UPDATE_DATATABLE_OPTIONS, value)\n      }\n    },\n    search: {\n      get () {\n        return this.$store.state.datatable.search\n      },\n      set (val) {\n        this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, val)\n        this.$store.dispatch(ACTIONS.GET_DATATABLE)\n      }\n    },\n    ...mapState({\n      // datatable module\n      headers: state => state.datatable.headers,\n      loading: state => state.datatable.loading,\n      elements: state => state.datatable.data,\n\n      // form module\n      inputs: state => state.form.inputs,\n      editedItem: state => state.form.editedItem,\n      formLoading: state => state.form.loading,\n      formErrors: state => state.form.errors\n    }),\n    ...mapGetters([\n      // datatable module\n      'totalElements',\n      'formatterColumns',\n      'editableColumns',\n      'rowEditables',\n      'rowActionsType',\n      'rowActions',\n      'mainFilters',\n\n      // form module\n      'defaultItem'\n    ])\n  },\n  methods: {\n    handleFunctionCall (functionName, ...val) {\n      // __log(functionName)\n      return this[functionName](...val)\n    },\n    initialize () {\n      this.$store.commit(DATATABLE.UPDATE_DATATABLE_SEARCH, '')\n      this.$store.commit(\n        DATATABLE.UPDATE_DATATABLE_OPTIONS,\n        window[process.env.VUE_APP_NAME].STORE.datatable.options\n      )\n      this.$store.dispatch(ACTIONS.GET_DATATABLE)\n    },\n    editItem (item) {\n      if (this.editOnModal) {\n        this.setEditedItem(item)\n        this.$refs.formModal.openModal()\n      } else {\n        const route = this.editUrl.replace(':id', item.id)\n        window.open(route)\n      }\n    },\n    deleteItem (item) {\n      this.setEditedItem(item)\n      this.$refs.dialog.openModal()\n    },\n    formatDate (value) {\n      // __log(value)\n      return this.$d(new Date(value), 'long')\n      return new Date(value).toLocaleString()\n    },\n\n    setEditedItem (item) {\n      // this.editedIndex = this.elements.indexOf(item)\n      // this.editedItem = Object.assign({}, item)\n      this.$store.commit(FORM.SET_EDITED_ITEM, item)\n    },\n    resetEditedItem () {\n      this.$nextTick(() => {\n        // this.editedItem = Object.assign({}, this.defaultItem)\n        this.$store.commit(FORM.SET_EDITED_ITEM, this.defaultItem)\n        // this.editedIndex = -1\n      })\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}