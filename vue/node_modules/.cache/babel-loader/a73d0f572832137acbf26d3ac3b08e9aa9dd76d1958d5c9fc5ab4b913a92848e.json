{"ast":null,"code":"import _objectSpread from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.string.starts-with.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport { ref, watch } from 'vue';\nimport { consoleError, consoleWarn, getObjectValueByPath } from \"../../util/index.mjs\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\";\nimport en from \"../en.mjs\";\nvar LANG_PREFIX = '$vuetify.';\nvar replace = function replace(str, params) {\n  return str.replace(/\\{(\\d+)\\}/g, function (match, index) {\n    return String(params[+index]);\n  });\n};\nvar createTranslateFunction = function createTranslateFunction(current, fallback, messages) {\n  return function (key) {\n    for (var _len = arguments.length, params = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      params[_key - 1] = arguments[_key];\n    }\n    if (!key.startsWith(LANG_PREFIX)) {\n      return replace(key, params);\n    }\n    var shortKey = key.replace(LANG_PREFIX, '');\n    var currentLocale = current.value && messages.value[current.value];\n    var fallbackLocale = fallback.value && messages.value[fallback.value];\n    var str = getObjectValueByPath(currentLocale, shortKey, null);\n    if (!str) {\n      consoleWarn(\"Translation key \\\"\".concat(key, \"\\\" not found in \\\"\").concat(current.value, \"\\\", trying fallback locale\"));\n      str = getObjectValueByPath(fallbackLocale, shortKey, null);\n    }\n    if (!str) {\n      consoleError(\"Translation key \\\"\".concat(key, \"\\\" not found in fallback\"));\n      str = key;\n    }\n    if (typeof str !== 'string') {\n      consoleError(\"Translation key \\\"\".concat(key, \"\\\" has a non-string value\"));\n      str = key;\n    }\n    return replace(str, params);\n  };\n};\nfunction createNumberFunction(current, fallback) {\n  return function (value, options) {\n    var numberFormat = new Intl.NumberFormat([current.value, fallback.value], options);\n    return numberFormat.format(value);\n  };\n}\nfunction useProvided(props, prop, provided) {\n  var _props$prop, _props$prop2;\n  var internal = useProxiedModel(props, prop, (_props$prop = props[prop]) !== null && _props$prop !== void 0 ? _props$prop : provided.value);\n\n  // TODO: Remove when defaultValue works\n  internal.value = (_props$prop2 = props[prop]) !== null && _props$prop2 !== void 0 ? _props$prop2 : provided.value;\n  watch(provided, function (v) {\n    if (props[prop] == null) {\n      internal.value = provided.value;\n    }\n  });\n  return internal;\n}\nfunction createProvideFunction(state) {\n  return function (props) {\n    var current = useProvided(props, 'locale', state.current);\n    var fallback = useProvided(props, 'fallback', state.fallback);\n    var messages = useProvided(props, 'messages', state.messages);\n    return {\n      name: 'vuetify',\n      current: current,\n      fallback: fallback,\n      messages: messages,\n      t: createTranslateFunction(current, fallback, messages),\n      n: createNumberFunction(current, fallback),\n      provide: createProvideFunction({\n        current: current,\n        fallback: fallback,\n        messages: messages\n      })\n    };\n  };\n}\nexport function createVuetifyAdapter(options) {\n  var _options$locale, _options$fallback;\n  var current = ref((_options$locale = options === null || options === void 0 ? void 0 : options.locale) !== null && _options$locale !== void 0 ? _options$locale : 'en');\n  var fallback = ref((_options$fallback = options === null || options === void 0 ? void 0 : options.fallback) !== null && _options$fallback !== void 0 ? _options$fallback : 'en');\n  var messages = ref(_objectSpread({\n    en: en\n  }, options === null || options === void 0 ? void 0 : options.messages));\n  return {\n    name: 'vuetify',\n    current: current,\n    fallback: fallback,\n    messages: messages,\n    t: createTranslateFunction(current, fallback, messages),\n    n: createNumberFunction(current, fallback),\n    provide: createProvideFunction({\n      current: current,\n      fallback: fallback,\n      messages: messages\n    })\n  };\n}","map":{"version":3,"names":["ref","watch","consoleError","consoleWarn","getObjectValueByPath","useProxiedModel","en","LANG_PREFIX","replace","str","params","match","index","String","createTranslateFunction","current","fallback","messages","key","_len","arguments","length","Array","_key","startsWith","shortKey","currentLocale","value","fallbackLocale","concat","createNumberFunction","options","numberFormat","Intl","NumberFormat","format","useProvided","props","prop","provided","_props$prop","_props$prop2","internal","v","createProvideFunction","state","name","t","n","provide","createVuetifyAdapter","_options$locale","_options$fallback","locale","_objectSpread"],"sources":["../../../src/locale/adapters/vuetify.ts"],"sourcesContent":["import { ref, watch } from 'vue'\nimport { consoleError, consoleWarn, getObjectValueByPath } from '@/util'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport en from '@/locale/en'\n\nimport type { Ref } from 'vue'\nimport type { LocaleInstance, LocaleMessages, LocaleOptions } from '@/composables/locale'\n\nconst LANG_PREFIX = '$vuetify.'\n\nconst replace = (str: string, params: unknown[]) => {\n  return str.replace(/\\{(\\d+)\\}/g, (match: string, index: string) => {\n    return String(params[+index])\n  })\n}\n\nconst createTranslateFunction = (\n  current: Ref<string>,\n  fallback: Ref<string>,\n  messages: Ref<LocaleMessages>,\n) => {\n  return (key: string, ...params: unknown[]) => {\n    if (!key.startsWith(LANG_PREFIX)) {\n      return replace(key, params)\n    }\n\n    const shortKey = key.replace(LANG_PREFIX, '')\n    const currentLocale = current.value && messages.value[current.value]\n    const fallbackLocale = fallback.value && messages.value[fallback.value]\n\n    let str: string = getObjectValueByPath(currentLocale, shortKey, null)\n\n    if (!str) {\n      consoleWarn(`Translation key \"${key}\" not found in \"${current.value}\", trying fallback locale`)\n      str = getObjectValueByPath(fallbackLocale, shortKey, null)\n    }\n\n    if (!str) {\n      consoleError(`Translation key \"${key}\" not found in fallback`)\n      str = key\n    }\n\n    if (typeof str !== 'string') {\n      consoleError(`Translation key \"${key}\" has a non-string value`)\n      str = key\n    }\n\n    return replace(str, params)\n  }\n}\n\nfunction createNumberFunction (current: Ref<string>, fallback: Ref<string>) {\n  return (value: number, options?: Intl.NumberFormatOptions) => {\n    const numberFormat = new Intl.NumberFormat([current.value, fallback.value], options)\n\n    return numberFormat.format(value)\n  }\n}\n\nfunction useProvided <T> (props: any, prop: string, provided: Ref<T>) {\n  const internal = useProxiedModel(props, prop, props[prop] ?? provided.value)\n\n  // TODO: Remove when defaultValue works\n  internal.value = props[prop] ?? provided.value\n\n  watch(provided, v => {\n    if (props[prop] == null) {\n      internal.value = provided.value\n    }\n  })\n\n  return internal as Ref<T>\n}\n\nfunction createProvideFunction (state: { current: Ref<string>, fallback: Ref<string>, messages: Ref<LocaleMessages> }) {\n  return (props: LocaleOptions): LocaleInstance => {\n    const current = useProvided(props, 'locale', state.current)\n    const fallback = useProvided(props, 'fallback', state.fallback)\n    const messages = useProvided(props, 'messages', state.messages)\n\n    return {\n      name: 'vuetify',\n      current,\n      fallback,\n      messages,\n      t: createTranslateFunction(current, fallback, messages),\n      n: createNumberFunction(current, fallback),\n      provide: createProvideFunction({ current, fallback, messages }),\n    }\n  }\n}\n\nexport function createVuetifyAdapter (options?: LocaleOptions): LocaleInstance {\n  const current = ref(options?.locale ?? 'en')\n  const fallback = ref(options?.fallback ?? 'en')\n  const messages = ref({ en, ...options?.messages })\n\n  return {\n    name: 'vuetify',\n    current,\n    fallback,\n    messages,\n    t: createTranslateFunction(current, fallback, messages),\n    n: createNumberFunction(current, fallback),\n    provide: createProvideFunction({ current, fallback, messages }),\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}