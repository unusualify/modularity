{"ast":null,"code":"import _objectSpread from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport axios from 'axios';\nimport { replaceState } from '@/utils/pushState.js';\n// import { globalError } from '@/utils/errors'\n\nvar component = 'DATATABLE';\nexport default {\n  /*\n    *\n    * Main listing request with multiple params\n    *\n    * sortKey : column used for sorting content\n    * sortDir : desc or asc\n    * page : current page number\n    * offset : number of items per page\n    * columns: the set of visible columns\n    * filter: the current navigation (\"all\", \"mine\", \"published\", \"draft\", \"trash\")\n    *\n    */\n  get: function get(params, callback) {\n    // console.log(\n    //     'store.api.datatable',\n    //     params\n    // )\n    var url = window[process.env.VUE_APP_NAME].ENDPOINTS.index;\n    var headers = {\n      'Content-type': 'application/json',\n      Accept: 'application/json'\n    };\n    __log({\n      params: params,\n      headers: headers\n    });\n    axios.get(url, _objectSpread({\n      params: params\n    }, headers)).then(function (resp) {\n      if (resp.data.replaceUrl) {\n        var _url = resp.request.responseURL;\n        replaceState(_url);\n      }\n      if (callback && typeof callback === 'function') {\n        // const data = {\n        //     // data: resp.data.data ? resp.data.data : [],\n        //     // data: resp.data.tableData ? resp.data.tableData : [],\n        //     // nav: resp.data.tableMainFilters ? resp.data.tableMainFilters : [],\n        //     // maxPage: (resp.data.maxPage ? resp.data.maxPage : 1)\n        // }\n\n        callback(resp.data.resource);\n      }\n    }, function (resp) {\n      var error = {\n        message: 'Get request error.',\n        value: resp\n      };\n      //   globalError(component, error)\n    });\n  },\n  // delete (item, callback) {\n  \"delete\": function _delete(id, callback) {\n    var url = window[process.env.VUE_APP_NAME].ENDPOINTS[\"delete\"].replace(':id', id);\n    // var url = window[process.env.VUE_APP_NAME].ENDPOINTS.index.replace(':id', item.id);\n\n    axios[\"delete\"](url).then(function (resp) {\n      if (callback && typeof callback === 'function') callback(resp);\n    }, function (resp) {\n      var error = {\n        message: 'Delete request error.',\n        value: resp\n      };\n      //   globalError(component, error)\n    });\n  }\n};","map":{"version":3,"names":["axios","replaceState","component","get","params","callback","url","window","process","env","VUE_APP_NAME","ENDPOINTS","index","headers","Accept","__log","_objectSpread","then","resp","data","replaceUrl","request","responseURL","resource","error","message","value","_delete","id","replace"],"sources":["/var/www/crm_template/packages/oobook/crm-base/vue/src/js/store/api/datatable.js"],"sourcesContent":["import axios from 'axios'\nimport { replaceState } from '@/utils/pushState.js'\n// import { globalError } from '@/utils/errors'\n\nconst component = 'DATATABLE'\n\nexport default {\n  /*\n    *\n    * Main listing request with multiple params\n    *\n    * sortKey : column used for sorting content\n    * sortDir : desc or asc\n    * page : current page number\n    * offset : number of items per page\n    * columns: the set of visible columns\n    * filter: the current navigation (\"all\", \"mine\", \"published\", \"draft\", \"trash\")\n    *\n    */\n  get (params, callback) {\n    // console.log(\n    //     'store.api.datatable',\n    //     params\n    // )\n    const url = window[process.env.VUE_APP_NAME].ENDPOINTS.index\n    const headers = { 'Content-type': 'application/json', Accept: 'application/json' }\n    __log(\n      { params, headers }\n    )\n    axios.get(url, { params, ...headers })\n      .then(function (resp) {\n        if (resp.data.replaceUrl) {\n          const url = resp.request.responseURL\n          replaceState(url)\n        }\n        if (callback && typeof callback === 'function') {\n          // const data = {\n          //     // data: resp.data.data ? resp.data.data : [],\n          //     // data: resp.data.tableData ? resp.data.tableData : [],\n          //     // nav: resp.data.tableMainFilters ? resp.data.tableMainFilters : [],\n          //     // maxPage: (resp.data.maxPage ? resp.data.maxPage : 1)\n          // }\n\n          callback(resp.data.resource)\n        }\n      }, function (resp) {\n        const error = {\n          message: 'Get request error.',\n          value: resp\n        }\n        //   globalError(component, error)\n      })\n  },\n\n  // delete (item, callback) {\n  delete (id, callback) {\n    const url = window[process.env.VUE_APP_NAME].ENDPOINTS.delete.replace(':id', id)\n    // var url = window[process.env.VUE_APP_NAME].ENDPOINTS.index.replace(':id', item.id);\n\n    axios.delete(url).then(function (resp) {\n      if (callback && typeof callback === 'function') callback(resp)\n    }, function (resp) {\n      const error = {\n        message: 'Delete request error.',\n        value: resp\n      }\n      //   globalError(component, error)\n    })\n  }\n\n}\n"],"mappings":";;;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,QAAQ,sBAAsB;AACnD;;AAEA,IAAMC,SAAS,GAAG,WAAW;AAE7B,eAAe;EACb;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEC,GAAG,WAAAA,IAAEC,MAAM,EAAEC,QAAQ,EAAE;IACrB;IACA;IACA;IACA;IACA,IAAMC,GAAG,GAAGC,MAAM,CAACC,OAAO,CAACC,GAAG,CAACC,YAAY,CAAC,CAACC,SAAS,CAACC,KAAK;IAC5D,IAAMC,OAAO,GAAG;MAAE,cAAc,EAAE,kBAAkB;MAAEC,MAAM,EAAE;IAAmB,CAAC;IAClFC,KAAK,CACH;MAAEX,MAAM,EAANA,MAAM;MAAES,OAAO,EAAPA;IAAQ,CAAC,CACpB;IACDb,KAAK,CAACG,GAAG,CAACG,GAAG,EAAAU,aAAA;MAAIZ,MAAM,EAANA;IAAM,GAAKS,OAAO,EAAG,CACnCI,IAAI,CAAC,UAAUC,IAAI,EAAE;MACpB,IAAIA,IAAI,CAACC,IAAI,CAACC,UAAU,EAAE;QACxB,IAAMd,IAAG,GAAGY,IAAI,CAACG,OAAO,CAACC,WAAW;QACpCrB,YAAY,CAACK,IAAG,CAAC;MACnB;MACA,IAAID,QAAQ,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAE;QAC9C;QACA;QACA;QACA;QACA;QACA;;QAEAA,QAAQ,CAACa,IAAI,CAACC,IAAI,CAACI,QAAQ,CAAC;MAC9B;IACF,CAAC,EAAE,UAAUL,IAAI,EAAE;MACjB,IAAMM,KAAK,GAAG;QACZC,OAAO,EAAE,oBAAoB;QAC7BC,KAAK,EAAER;MACT,CAAC;MACD;IACF,CAAC,CAAC;EACN,CAAC;EAED;EAAA,mBAAAS,QACQC,EAAE,EAAEvB,QAAQ,EAAE;IACpB,IAAMC,GAAG,GAAGC,MAAM,CAACC,OAAO,CAACC,GAAG,CAACC,YAAY,CAAC,CAACC,SAAS,UAAO,CAACkB,OAAO,CAAC,KAAK,EAAED,EAAE,CAAC;IAChF;;IAEA5B,KAAK,UAAO,CAACM,GAAG,CAAC,CAACW,IAAI,CAAC,UAAUC,IAAI,EAAE;MACrC,IAAIb,QAAQ,IAAI,OAAOA,QAAQ,KAAK,UAAU,EAAEA,QAAQ,CAACa,IAAI,CAAC;IAChE,CAAC,EAAE,UAAUA,IAAI,EAAE;MACjB,IAAMM,KAAK,GAAG;QACZC,OAAO,EAAE,uBAAuB;QAChCC,KAAK,EAAER;MACT,CAAC;MACD;IACF,CAAC,CAAC;EACJ;AAEF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}