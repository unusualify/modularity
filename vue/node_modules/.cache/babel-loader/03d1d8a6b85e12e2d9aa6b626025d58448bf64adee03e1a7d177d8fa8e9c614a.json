{"ast":null,"code":"import _objectSpread from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport { withDirectives as _withDirectives, resolveDirective as _resolveDirective, createVNode as _createVNode } from \"vue\";\n// Composables\nimport { makeDimensionProps, useDimension } from \"../../composables/dimensions.mjs\";\nimport { makeTagProps } from \"../../composables/tag.mjs\";\nimport { makeTransitionProps, MaybeTransition } from \"../../composables/transition.mjs\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\"; // Directives\nimport intersect from \"../../directives/intersect/index.mjs\"; // Utilities\nimport { genericComponent, useRender } from \"../../util/index.mjs\"; // Types\nexport var VLazy = genericComponent()({\n  name: 'VLazy',\n  directives: {\n    intersect: intersect\n  },\n  props: _objectSpread(_objectSpread(_objectSpread({\n    modelValue: Boolean,\n    options: {\n      type: Object,\n      // For more information on types, navigate to:\n      // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n      \"default\": function _default() {\n        return {\n          root: undefined,\n          rootMargin: undefined,\n          threshold: undefined\n        };\n      }\n    }\n  }, makeDimensionProps()), makeTagProps()), makeTransitionProps({\n    transition: 'fade-transition'\n  })),\n  emits: {\n    'update:modelValue': function updateModelValue(value) {\n      return true;\n    }\n  },\n  setup: function setup(props, _ref) {\n    var slots = _ref.slots;\n    var _useDimension = useDimension(props),\n      dimensionStyles = _useDimension.dimensionStyles;\n    var isActive = useProxiedModel(props, 'modelValue');\n    function onIntersect(isIntersecting) {\n      if (isActive.value) return;\n      isActive.value = isIntersecting;\n    }\n    useRender(function () {\n      return _withDirectives(_createVNode(props.tag, {\n        \"class\": \"v-lazy\",\n        \"style\": dimensionStyles.value\n      }, {\n        \"default\": function _default() {\n          return [isActive.value && _createVNode(MaybeTransition, {\n            \"transition\": props.transition,\n            \"appear\": true\n          }, {\n            \"default\": function _default() {\n              var _slots$default;\n              return [(_slots$default = slots[\"default\"]) === null || _slots$default === void 0 ? void 0 : _slots$default.call(slots)];\n            }\n          })];\n        }\n      }), [[_resolveDirective(\"intersect\"), onIntersect, props.options]]);\n    });\n    return {};\n  }\n});","map":{"version":3,"names":["makeDimensionProps","useDimension","makeTagProps","makeTransitionProps","MaybeTransition","useProxiedModel","intersect","genericComponent","useRender","VLazy","name","directives","props","_objectSpread","modelValue","Boolean","options","type","Object","_default","root","undefined","rootMargin","threshold","transition","emits","updateModelValue","value","setup","_ref","slots","_useDimension","dimensionStyles","isActive","onIntersect","isIntersecting","_withDirectives","_createVNode","tag","_slots$default","call","_resolveDirective"],"sources":["../../../src/components/VLazy/VLazy.tsx"],"sourcesContent":["// Composables\nimport { makeDimensionProps, useDimension } from '@/composables/dimensions'\nimport { makeTagProps } from '@/composables/tag'\nimport { makeTransitionProps, MaybeTransition } from '@/composables/transition'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Directives\nimport intersect from '@/directives/intersect'\n\n// Utilities\nimport { genericComponent, useRender } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\n\nexport const VLazy = genericComponent()({\n  name: 'VLazy',\n\n  directives: { intersect },\n\n  props: {\n    modelValue: Boolean,\n    options: {\n      type: Object as PropType<IntersectionObserverInit>,\n      // For more information on types, navigate to:\n      // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n      default: () => ({\n        root: undefined,\n        rootMargin: undefined,\n        threshold: undefined,\n      }),\n    },\n\n    ...makeDimensionProps(),\n    ...makeTagProps(),\n    ...makeTransitionProps({ transition: 'fade-transition' }),\n  },\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const { dimensionStyles } = useDimension(props)\n\n    const isActive = useProxiedModel(props, 'modelValue')\n\n    function onIntersect (isIntersecting: boolean) {\n      if (isActive.value) return\n\n      isActive.value = isIntersecting\n    }\n\n    useRender(() => (\n      <props.tag\n        class=\"v-lazy\"\n        v-intersect={[\n          onIntersect,\n          props.options,\n          isActive.value ? [] : ['once'],\n        ]}\n        style={ dimensionStyles.value }\n      >\n        { isActive.value && (\n          <MaybeTransition transition={ props.transition } appear>\n            { slots.default?.() }\n          </MaybeTransition>\n        )}\n      </props.tag>\n    ))\n\n    return {}\n  },\n})\n\nexport type VLazy = InstanceType<typeof VLazy>\n"],"mappings":";;AAAA;AAAA,SACSA,kBAAkB,EAAEC,YAAY;AAAA,SAChCC,YAAY;AAAA,SACZC,mBAAmB,EAAEC,eAAe;AAAA,SACpCC,eAAe,8CAExB;AAAA,OACOC,SAAS,8CAEhB;AAAA,SACSC,gBAAgB,EAAEC,SAAS,gCAEpC;AAGA,OAAO,IAAMC,KAAK,GAAGF,gBAAgB,EAAE,CAAC;EACtCG,IAAI,EAAE,OAAO;EAEbC,UAAU,EAAE;IAAEL,SAAA,EAAAA;EAAU,CAAC;EAEzBM,KAAK,EAAAC,aAAA,CAAAA,aAAA,CAAAA,aAAA;IACHC,UAAU,EAAEC,OAAO;IACnBC,OAAO,EAAE;MACPC,IAAI,EAAEC,MAA4C;MAClD;MACA;MACA,WAAS,SAAAC,SAAA;QAAA,OAAO;UACdC,IAAI,EAAEC,SAAS;UACfC,UAAU,EAAED,SAAS;UACrBE,SAAS,EAAEF;QACb,CAAC;MAAA;IACH;EAAC,GAEErB,kBAAkB,EAAE,GACpBE,YAAY,EAAE,GACdC,mBAAmB,CAAC;IAAEqB,UAAU,EAAE;EAAkB,CAAC,EACzD;EAEDC,KAAK,EAAE;IACL,mBAAmB,EAAG,SAAAC,iBAAAC,KAAc;MAAA,OAAK;IAAA;EAC3C,CAAC;EAEDC,KAAK,WAAAA,MAAEhB,KAAK,EAAAiB,IAAA,EAAa;IAAA,IAATC,KAAA,GAAOD,IAAA,CAAPC,KAAA;IACd,IAAAC,aAAA,GAA4B9B,YAAY,CAACW,KAAK,CAAC;MAAvCoB,eAAA,GAAAD,aAAA,CAAAC,eAAA;IAER,IAAMC,QAAQ,GAAG5B,eAAe,CAACO,KAAK,EAAE,YAAY,CAAC;IAErD,SAASsB,WAAWA,CAAEC,cAAuB,EAAE;MAC7C,IAAIF,QAAQ,CAACN,KAAK,EAAE;MAEpBM,QAAQ,CAACN,KAAK,GAAGQ,cAAc;IACjC;IAEA3B,SAAS,CAAC;MAAA,OAAA4B,eAAA,CAAAC,YAAA,CAAAzB,KAAA,CAAA0B,GAAA;QAAA,SAEA,QAAQ;QAAA,SAMNN,eAAe,CAACL;MAAK;QAAA,oBAAAR,SAAA;UAAA,QAE3Bc,QAAQ,CAACN,KAAK,IAAAU,YAAA,CAAAjC,eAAA;YAAA,cACgBQ,KAAK,CAACY,UAAU;YAAA;UAAA;YAAA,oBAAAL,SAAA;cAAA,IAAAoB,cAAA;cAAA,SAAAA,cAAA,GAC1CT,KAAK,WAAQ,cAAAS,cAAA,uBAAbA,cAAA,CAAAC,IAAA,CAAAV,KAAK,CAAY;YAAA;UAAA,EAEtB;QAAA;MAAA,MAAAW,iBAAA,eAVCP,WAAW,EACXtB,KAAK,CAACI,OAAO,GAWlB;IAAA,EAAC;IAEF,OAAO,CAAC,CAAC;EACX;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}