{"ast":null,"code":"import _typeof from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport _objectWithoutProperties from \"/var/www/crm_template/packages/oobook/crm-base/vue/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nvar _excluded = [\"once\", \"immediate\"];\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.string.sub.js\";\n// Types\n\nfunction mounted(el, binding) {\n  var _modifierKeys$attr, _modifierKeys$char, _modifierKeys$child, _modifierKeys$sub;\n  var modifiers = binding.modifiers || {};\n  var value = binding.value;\n  var once = modifiers.once,\n    immediate = modifiers.immediate,\n    modifierKeys = _objectWithoutProperties(modifiers, _excluded);\n  var defaultValue = !Object.keys(modifierKeys).length;\n  var _ref = _typeof(value) === 'object' ? value : {\n      handler: value,\n      options: {\n        attributes: (_modifierKeys$attr = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.attr) !== null && _modifierKeys$attr !== void 0 ? _modifierKeys$attr : defaultValue,\n        characterData: (_modifierKeys$char = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys[\"char\"]) !== null && _modifierKeys$char !== void 0 ? _modifierKeys$char : defaultValue,\n        childList: (_modifierKeys$child = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.child) !== null && _modifierKeys$child !== void 0 ? _modifierKeys$child : defaultValue,\n        subtree: (_modifierKeys$sub = modifierKeys === null || modifierKeys === void 0 ? void 0 : modifierKeys.sub) !== null && _modifierKeys$sub !== void 0 ? _modifierKeys$sub : defaultValue\n      }\n    },\n    handler = _ref.handler,\n    options = _ref.options;\n  var observer = new MutationObserver(function () {\n    var mutations = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var observer = arguments.length > 1 ? arguments[1] : undefined;\n    handler === null || handler === void 0 ? void 0 : handler(mutations, observer);\n    if (once) unmounted(el, binding);\n  });\n  if (immediate) handler === null || handler === void 0 ? void 0 : handler([], observer);\n  el._mutate = Object(el._mutate);\n  el._mutate[binding.instance.$.uid] = {\n    observer: observer\n  };\n  observer.observe(el, options);\n}\nfunction unmounted(el, binding) {\n  var _el$_mutate;\n  if (!((_el$_mutate = el._mutate) !== null && _el$_mutate !== void 0 && _el$_mutate[binding.instance.$.uid])) return;\n  el._mutate[binding.instance.$.uid].observer.disconnect();\n  delete el._mutate[binding.instance.$.uid];\n}\nexport var Mutate = {\n  mounted: mounted,\n  unmounted: unmounted\n};\nexport default Mutate;","map":{"version":3,"names":["mounted","el","binding","_modifierKeys$attr","_modifierKeys$char","_modifierKeys$child","_modifierKeys$sub","modifiers","value","once","immediate","modifierKeys","_objectWithoutProperties","_excluded","defaultValue","Object","keys","length","_ref","_typeof","handler","options","attributes","attr","characterData","childList","child","subtree","sub","observer","MutationObserver","mutations","arguments","undefined","unmounted","_mutate","instance","$","uid","observe","_el$_mutate","disconnect","Mutate"],"sources":["../../../src/directives/mutate/index.ts"],"sourcesContent":["// Types\nimport type { DirectiveBinding } from 'vue'\nimport type { MutationOptions } from '@/composables/mutationObserver'\n\nexport interface MutationDirectiveBinding extends Omit<DirectiveBinding, 'modifiers' | 'value'> {\n  value: MutationCallback | { handler: MutationCallback, options?: MutationObserverInit }\n  modifiers: MutationOptions\n}\n\nfunction mounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  const modifiers = binding.modifiers || {}\n  const value = binding.value\n  const { once, immediate, ...modifierKeys } = modifiers\n  const defaultValue = !Object.keys(modifierKeys).length\n\n  const { handler, options } = typeof value === 'object'\n    ? value\n    : {\n      handler: value,\n      options: {\n        attributes: modifierKeys?.attr ?? defaultValue,\n        characterData: modifierKeys?.char ?? defaultValue,\n        childList: modifierKeys?.child ?? defaultValue,\n        subtree: modifierKeys?.sub ?? defaultValue,\n      },\n    }\n\n  const observer = new MutationObserver((\n    mutations: MutationRecord[] = [],\n    observer: MutationObserver\n  ) => {\n    handler?.(mutations, observer)\n\n    if (once) unmounted(el, binding)\n  })\n\n  if (immediate) handler?.([], observer)\n\n  el._mutate = Object(el._mutate)\n  el._mutate![binding.instance!.$.uid] = { observer }\n\n  observer.observe(el, options)\n}\n\nfunction unmounted (el: HTMLElement, binding: MutationDirectiveBinding) {\n  if (!el._mutate?.[binding.instance!.$.uid]) return\n\n  el._mutate[binding.instance!.$.uid]!.observer.disconnect()\n  delete el._mutate[binding.instance!.$.uid]\n}\n\nexport const Mutate = {\n  mounted,\n  unmounted,\n}\n\nexport default Mutate\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}